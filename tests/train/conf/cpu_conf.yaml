env:
  seed: 1337
  numpy_seed: 1337
  jax_seed: 1337
  epochs: 11
  accum_steps: 8
  save_checkpoint:
    params:
      ckpt_dir: "outs/checkpoints/"
      keep: 1
      overwrite: True
      keep_every_n_steps: 10
  restore_checkpoint:
    params: {}
  half_precision: False
  dynamic_scale:
    params: {}

trainer:
  name: SSLTrainer

model:
  name: SSLModel
  branches:
    0:
      name: CPUOnlineBranch
      params: {}
    1:
      name: CPUTargetBranch
      params: {}


loss: byol_regression_loss

optimizers:
  branches:
    0:
      name: sgd
      params:
        learning_rate: 0.01
    1:
      name: sgd
      params:
        learning_rate: 0.01

schedulers:
  branches:
    0:
      name: cosine_decay
      params:
        init_value: 0.01
        decay_steps: 1000
    1:
      name: cosine_decay
      params:
        init_value: 0.01
        decay_steps: 1000

meter:
  name: SSLMeter

pipelines:
  branches:
    0:
      name: CPUPipeline
      params: {}
    1:
      name: CPUPipeline
      params: {}

dataloader:
  name: mnist
  params:
    batch_size: 32
    input_shape: (784,)
